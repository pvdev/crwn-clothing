{"ast":null,"code":"import _regeneratorRuntime from \"/Users/pvessels/Dropbox/development/react-complete-dev-2019/crwn-clothing/node_modules/@babel/runtime/regenerator\";\nimport _defineProperty from \"/Users/pvessels/Dropbox/development/react-complete-dev-2019/crwn-clothing/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _asyncToGenerator from \"/Users/pvessels/Dropbox/development/react-complete-dev-2019/crwn-clothing/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nvar _jsxFileName = \"/Users/pvessels/Dropbox/development/react-complete-dev-2019/crwn-clothing/src/App.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useEffect } from 'react';\nimport { Switch, Route, Redirect, withRouter } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport { createStructuredSelector } from 'reselect';\nimport './App.css';\nimport HomePage from './pages/homepage/homepage.component';\nimport ShopPage from './pages/shop/shop.component';\nimport CheckoutPage from './pages/checkout/checkout.component';\nimport SignInAndSignUp from './components/sign-in-and-sign-up/sign-in-and-sign-up.component';\nimport Header from './components/header/header.component';\nimport { auth, createUserProfileDocument } from './firebase/firebase.utils';\nimport { setCurrentUser } from './redux/user/user.actions';\nimport { selectCurrentUser } from './redux/user/user.selector';\n\nvar App = function App(_ref) {\n  var setCurrentUser = _ref.setCurrentUser,\n      currentUser = _ref.currentUser;\n  useEffect(function () {\n    console.log('Appjs calling useEffect/componentDidMount'); // auth.onAuthStateChanged sets up a listener for authn changes\n    // we pass the 'next' function and returns a function to unsubscribe user\n\n    var unsubscribeFromAuth = auth.onAuthStateChanged(\n    /*#__PURE__*/\n    function () {\n      var _ref2 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(userAuth) {\n        var userRef;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (!userAuth) {\n                  _context.next = 7;\n                  break;\n                }\n\n                _context.next = 3;\n                return createUserProfileDocument(userAuth);\n\n              case 3:\n                userRef = _context.sent;\n                userRef.onSnapshot(function (snapShot) {\n                  setCurrentUser(_objectSpread({\n                    id: snapShot.id\n                  }, snapShot.data()));\n                });\n                _context.next = 8;\n                break;\n\n              case 7:\n                setCurrentUser(null);\n\n              case 8:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function (_x) {\n        return _ref2.apply(this, arguments);\n      };\n    }()); // add cleanup function for willUnmount scenario\n\n    return function () {\n      unsubscribeFromAuth();\n    };\n  }, [setCurrentUser]);\n  return React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 49\n    },\n    __self: this\n  }, React.createElement(Header, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 50\n    },\n    __self: this\n  }), React.createElement(Switch, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 51\n    },\n    __self: this\n  }, React.createElement(Route, {\n    exact: true,\n    path: \"/\",\n    component: HomePage,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 52\n    },\n    __self: this\n  }), React.createElement(Route, {\n    path: \"/shop\",\n    component: ShopPage,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 53\n    },\n    __self: this\n  }), React.createElement(Route, {\n    exact: true,\n    path: \"/checkout\",\n    component: CheckoutPage,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54\n    },\n    __self: this\n  }), React.createElement(Route, {\n    exact: true,\n    path: \"/signin\",\n    render: function render() {\n      if (currentUser) {\n        //this.props.history.push('/')\n        // console.log('Redirecting to /')\n        return React.createElement(Redirect, {\n          to: \"/\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 63\n          },\n          __self: this\n        }); //return <HomePage />\n      } else {\n        return React.createElement(SignInAndSignUp, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 66\n          },\n          __self: this\n        });\n      }\n    } //   this.props.currentUser ? <Redirect to='/' /> : <SignInAndSignUp />\n    ,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55\n    },\n    __self: this\n  }), React.createElement(Route, {\n    component: NoMatch,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72\n    },\n    __self: this\n  })));\n};\n\nvar NoMatch = function NoMatch(props) {\n  var location = props.location;\n  console.log('No Route: ', props);\n  return React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82\n    },\n    __self: this\n  }, React.createElement(\"h3\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83\n    },\n    __self: this\n  }, \"No match for \", React.createElement(\"code\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84\n    },\n    __self: this\n  }, location.pathname), \".\"));\n}; // const mapStateToProps = ({ user }) => ({\n//   currentUser: user.currentUser,\n// })\n\n\nvar mapStateToProps = createStructuredSelector({\n  currentUser: selectCurrentUser\n}); // const mapDispatchToProps = dispatch => ({\n//   setCurrentUser: user => dispatch(setCurrentUser(user)),\n// })\n\nvar mapDispatchToProps = {\n  setCurrentUser: setCurrentUser\n};\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(App));","map":{"version":3,"sources":["/Users/pvessels/Dropbox/development/react-complete-dev-2019/crwn-clothing/src/App.js"],"names":["React","useEffect","Switch","Route","Redirect","withRouter","connect","createStructuredSelector","HomePage","ShopPage","CheckoutPage","SignInAndSignUp","Header","auth","createUserProfileDocument","setCurrentUser","selectCurrentUser","App","currentUser","console","log","unsubscribeFromAuth","onAuthStateChanged","userAuth","userRef","onSnapshot","snapShot","id","data","NoMatch","props","location","pathname","mapStateToProps","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React, { useEffect } from 'react'\nimport { Switch, Route, Redirect, withRouter } from 'react-router-dom'\nimport { connect } from 'react-redux'\nimport { createStructuredSelector } from 'reselect'\n\nimport './App.css'\nimport HomePage from './pages/homepage/homepage.component'\nimport ShopPage from './pages/shop/shop.component'\nimport CheckoutPage from './pages/checkout/checkout.component'\nimport SignInAndSignUp from './components/sign-in-and-sign-up/sign-in-and-sign-up.component'\n\nimport Header from './components/header/header.component'\n\nimport { auth, createUserProfileDocument } from './firebase/firebase.utils'\n\nimport { setCurrentUser } from './redux/user/user.actions'\nimport { selectCurrentUser } from './redux/user/user.selector'\n\nconst App = ({ setCurrentUser, currentUser }) => {\n  useEffect(() => {\n    console.log('Appjs calling useEffect/componentDidMount')\n\n    // auth.onAuthStateChanged sets up a listener for authn changes\n    // we pass the 'next' function and returns a function to unsubscribe user\n    const unsubscribeFromAuth = auth.onAuthStateChanged(async userAuth => {\n      // console.log('userAuth:: ', userAuth)\n      if (userAuth) {\n        const userRef = await createUserProfileDocument(userAuth)\n\n        // attach listener with onNext\n        userRef.onSnapshot(snapShot => {\n          setCurrentUser({\n            id: snapShot.id,\n            ...snapShot.data(),\n          })\n        })\n      } else {\n        setCurrentUser(null)\n      }\n    })\n\n    // add cleanup function for willUnmount scenario\n    return () => {\n      unsubscribeFromAuth()\n    }\n  }, [setCurrentUser])\n\n  return (\n    <div>\n      <Header />\n      <Switch>\n        <Route exact path='/' component={HomePage} />\n        <Route path='/shop' component={ShopPage} />\n        <Route exact path='/checkout' component={CheckoutPage} />\n        <Route\n          exact\n          path='/signin'\n          render={\n            () => {\n              if (currentUser) {\n                //this.props.history.push('/')\n                // console.log('Redirecting to /')\n                return <Redirect to='/' />\n                //return <HomePage />\n              } else {\n                return <SignInAndSignUp />\n              }\n            }\n            //   this.props.currentUser ? <Redirect to='/' /> : <SignInAndSignUp />\n          }\n        />\n        <Route component={NoMatch} />\n      </Switch>\n    </div>\n  )\n}\n\nconst NoMatch = props => {\n  const { location } = props\n  console.log('No Route: ', props)\n  return (\n    <div>\n      <h3>\n        No match for <code>{location.pathname}</code>.\n      </h3>\n    </div>\n  )\n}\n\n// const mapStateToProps = ({ user }) => ({\n//   currentUser: user.currentUser,\n// })\n\nconst mapStateToProps = createStructuredSelector({\n  currentUser: selectCurrentUser,\n})\n\n// const mapDispatchToProps = dispatch => ({\n//   setCurrentUser: user => dispatch(setCurrentUser(user)),\n// })\nconst mapDispatchToProps = { setCurrentUser }\n\nexport default withRouter(\n  connect(\n    mapStateToProps,\n    mapDispatchToProps\n  )(App)\n)\n"]},"metadata":{},"sourceType":"module"}